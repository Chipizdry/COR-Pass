<!DOCTYPE html>
<html>
    <head>
        <link rel="icon" type="image/png" href="/static/favicon.png">
        <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
        <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
        <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
        <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
        <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
        <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
        <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
        <meta name="msapplication-TileColor" content="#ffffff">
        <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
        <meta name="theme-color" content="#ffffff">
    
        <title>Авторизация и регистрация</title>
        <link rel="stylesheet" type="text/css" href="static/styles.css">
        <meta name="google-signin-client_id" content="161352424929-s3ris9429m994vcm2m35epe6eu4538el.apps.googleusercontent.com">
        <!-- <script src="https://apis.google.com/js/platform.js" async defer></script> -->
        <meta name="facebook-sdk-version" content="v15.0" />
        <script src="https://connect.facebook.net/en_US/sdk.js"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0-beta.1/css/select2.min.css" rel="stylesheet" />
        <style>
            button,
            .google-signin-btn,
            .custom-btn {
                font-family: inherit; /* Наследовать шрифт от родительского элемента */
                font-size: 16px; /* Размер шрифта */
            }
    
            .custom-btn img {
                margin-right: 10px;
                align-items: center;
            }
    
            .g-signin2 {
                display: none; /* Скрыть стандартную кнопку */
            }
    
            .google-signin-btn {
                display: inline-flex;
                align-items: center;
                justify-content: center;
                padding: 5px 10px;
                border: none;
                border-radius: 5px;
                background-color: #4285f4;
                color: white;
                cursor: pointer;
                margin-top: 10px;
                width: 100%;
                max-width: 200px;
            }
    
            .google-signin-btn img {
                margin-right: 10px;
            }


            .modal {
                display: none;
                position: fixed;
                
                z-index: 1;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.5);
            }
       
            .modal-content {
                position: relative; /* Добавьте это свойство */
                display: flex;
                flex-direction: column;
                align-items: center; /* Центрирование по горизонтали */
                justify-content: center; /* Центрирование по вертикали */
                background-color: #fff;
                margin: 5% auto;
                padding: 20px;
                border: 1px solid #888;
                width: 30%;
                border-radius: 30px;
            }

            .close-btn {
                position: absolute;
                top: 10px;
                right: 10px;
                font-size: 28px;
                font-weight: bold;
                cursor: pointer;
            }

            .close-btn:hover, .close-btn:focus {
                color: red;
            }


            #file-upload-field input[type="file"] {
                display: block;
                margin-top: 10px;
                width: 100%;
            }
        </style>
</head>
<body>
<div class="container">
    
    <script src="static/translation.js"></script>
    <script src="static/general_fun.js"></script>

    <div class="logo">
   
        <svg width="100" height="30" viewBox="0 0 142 46" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_3177_20583)">
            <path d="M124.549 23.2737H113.901L129.188 45.2791H141.045L131.462 31.4543C136.968 28.8526 140.784 23.2446 140.784 16.7617C140.784 7.8078 133.502 0.522657 124.549 0.522657H102.311V45.2791H112.038V10.2511H124.549C128.141 10.2511 131.06 13.1709 131.06 16.7617C131.06 20.353 128.141 23.2737 124.549 23.2737Z" fill="#ED1064"/>
            <path d="M23.944 36.2649C16.632 36.2649 10.6815 30.3164 10.6797 23.0027L10.6668 22.9964L10.6797 22.9903C10.684 15.6765 16.632 9.72757 23.944 9.72757C27.5765 9.72757 30.8733 11.198 33.2712 13.5723L42.6554 9.6591C38.4829 3.81718 31.652 0 23.944 0C11.2677 0 0.95459 10.3163 0.95459 22.9964C0.95459 35.6767 11.2677 45.9929 23.944 45.9929C31.652 45.9929 38.4829 42.1748 42.6554 36.3334L33.2712 32.4216C30.8733 34.7955 27.5765 36.2649 23.944 36.2649Z" fill="#ED1064"/>
            <path d="M66.0385 15.649H62.954V30.3564H66.0385V15.649Z" fill="#7527B2"/>
            <path d="M79.8081 17.7289C78.4551 16.3422 76.737 15.6489 74.6535 15.6489H69.2758V30.3563H74.6535C76.737 30.3563 78.4551 29.663 79.8081 28.2763C81.1745 26.8756 81.8577 25.1107 81.8577 22.9816C81.8577 20.8525 81.1745 19.1016 79.8081 17.7289ZM77.5555 26.1542C76.7843 26.9806 75.79 27.3938 74.5724 27.3938H72.3603V18.6114H74.5724C75.79 18.6114 76.7843 19.0176 77.5555 19.83C78.3267 20.6424 78.7122 21.6929 78.7122 22.9816C78.7122 24.2703 78.3267 25.3277 77.5555 26.1542Z" fill="#7527B2"/>
            <path fill-rule="evenodd" clip-rule="evenodd" d="M57.6496 30.1136C56.562 27.9792 55.9488 25.5626 55.9488 23.0027C55.9488 21.056 56.3199 19.2001 56.9681 17.4802L56.9515 17.4756C56.9515 17.4756 57.9286 12.1198 60.9689 8.00596C62.6904 5.67674 63.6183 4.67899 65.1869 3.24857C67.8529 0.8174 69.5436 0.132977 69.6361 0.096452C57.8705 1.10531 48.6337 10.9721 48.6337 23.0027C48.6337 28.9585 50.897 34.3854 54.6101 38.47C54.8796 38.7662 55.3627 38.6444 55.4726 38.2593L57.6884 30.5014C57.7255 30.372 57.7107 30.2335 57.6496 30.1136Z" fill="url(#paint0_linear_3177_20583)"/>
            <path fill-rule="evenodd" clip-rule="evenodd" d="M73.1888 45.941C74.7854 45.2284 77.2915 43.6953 80.5784 40.3764C82.2496 38.6889 83.6227 36.3438 84.5411 34.095C85.266 32.3199 85.8022 30.332 86.135 28.9211C83.7992 34.6451 78.1863 38.6826 71.6239 38.6826C69.2727 38.6826 67.0425 38.1649 65.0409 37.237C64.9288 37.185 64.802 37.1727 64.6824 37.204L56.5743 39.3293C56.1797 39.4327 56.0521 39.9266 56.3568 40.1975C60.4171 43.8073 65.7646 46 71.6239 46C72.1504 46 72.6711 45.9759 73.1888 45.941Z" fill="url(#paint1_linear_3177_20583)"/>
            <path fill-rule="evenodd" clip-rule="evenodd" d="M94.6144 23.0026C94.6144 10.3016 84.3213 0.0052998 71.624 0.0052998C70.9538 0.0052998 70.2919 0.0402436 69.6361 0.096452C69.5436 0.132977 67.8529 0.8174 65.1869 3.24857C63.6183 4.67899 62.6904 5.67674 60.9689 8.00596C57.9286 12.1198 56.9515 17.4756 56.9515 17.4756L56.9681 17.4802C59.2033 11.5493 64.913 7.32264 71.624 7.32264C80.2813 7.32264 87.2993 14.3428 87.2993 23.0026C87.2993 25.0981 86.8805 27.0939 86.135 28.9211C85.8021 30.332 84.9478 32.7517 84.0159 34.4274C83.2985 35.7174 82.5374 36.9624 81.7561 38.1017C80.9542 39.2708 80.1311 40.3286 79.312 41.2094C77.1791 43.503 74.7855 45.2283 73.1888 45.941C85.1554 45.1355 94.6144 35.177 94.6144 23.0026Z" fill="url(#paint2_linear_3177_20583)"/>
            </g>
            <defs>
            <linearGradient id="paint0_linear_3177_20583" x1="-12.4711" y1="40.4517" x2="-8.96669" y2="-1.59578" gradientUnits="userSpaceOnUse">
            <stop stop-color="#7527B2"/>
            <stop offset="1" stop-color="#AB77EB"/>
            </linearGradient>
            <linearGradient id="paint1_linear_3177_20583" x1="159.347" y1="17.8436" x2="50.6366" y2="-50.6245" gradientUnits="userSpaceOnUse">
            <stop stop-color="#7527B2"/>
            <stop offset="0.5" stop-color="#904FCF"/>
            <stop offset="1" stop-color="#AB77EB"/>
            </linearGradient>
            <linearGradient id="paint2_linear_3177_20583" x1="69.559" y1="-0.0967435" x2="86.0478" y2="47.3497" gradientUnits="userSpaceOnUse">
            <stop stop-color="#7527B2"/>
            <stop offset="0.5" stop-color="#7B43F2"/>
            <stop offset="1" stop-color="#AB77EB"/>
            </linearGradient>
            <clipPath id="clip0_3177_20583">
            <rect width="140.091" height="46" fill="white" transform="translate(0.95459)"/>
            </clipPath>
            </defs>
            </svg> <br>
            


    </div>    
    <h1 data-translate="title">Authorization and Registration</h1>
    <form id="login-form">
        <label for="email" data-translate="email-label"   style=" color:#7f69bd;font-size:14px;">Email:</label>
        <input type="email" id="email" name="username" required>
    
        <label for="password" data-translate="password-label"  style=" color:#7f69bd;font-size:14px;" >Password:</label>
        <div class="password-container">
            <input type="password" id="password" name="password" required   data-translate="password_placeholder">
          <span id="eyeIcon" class="eye-icon" onclick="togglePassword()"> 
                <!-- SVG иконка глаза -->
              <svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g id="icon / 24x24 / eye closed">
                    <path id="Vector" d="M22.5469 14.6062C22.4594 14.6561 22.3629 14.6882 22.263 14.7008C22.163
                       14.7133 22.0616 14.7061 21.9645 14.6794C21.8674 14.6527 21.7765 14.6071 21.697 14.5453C21.6175
                       14.4834 21.551 14.4065 21.5013 14.3189L19.6819 11.1399C18.6242 11.8551 17.4575 12.3938 16.2272
                       12.7351L16.7892 16.1076C16.8058 16.2069 16.8027 16.3084 16.78 16.4065C16.7573 16.5046 16.7155 
                       16.5972 16.657 16.6791C16.5985 16.761 16.5244 16.8306 16.439 16.8838C16.3535 16.9371 16.2585 
                       16.973 16.1592 16.9895C16.1183 16.9962 16.077 16.9997 16.0357 17C15.8544 16.9997 15.6792 16.9352
                       15.541 16.8179C15.4029 16.7006 15.3108 16.5382 15.2811 16.3594L14.7286 13.0483C13.5635 13.2104 
                       12.3815 13.2104 11.2164 13.0483L10.6639 16.3594C10.6342 16.5385 10.5418 16.7012 10.4033 
                       16.8186C10.2647 16.9359 10.089 17.0002 9.90745 17C9.8651 16.9998 9.82284 16.9963 9.78105 
                       16.9895C9.68175 16.973 9.58668 16.9371 9.50127 16.8838C9.41585 16.8306 9.34177 16.761 9.28326
                       16.6791C9.22474 16.5972 9.18294 16.5046 9.16025 16.4065C9.13756 16.3084 9.13441 16.2069 9.15099
                       16.1076L9.71594 12.7351C8.48611 12.3927 7.32 11.853 6.26308 11.137L4.44951 14.3189C4.39921 
                       14.4066 4.33214 14.4834 4.25213 14.5452C4.17212 14.6069 4.08074 14.6522 3.9832 14.6786C3.88566
                       14.7051 3.78387 14.712 3.68365 14.6991C3.58343 14.6861 3.48674 14.6536 3.3991 14.6033C3.31145
                       14.553 3.23457 14.4859 3.17285 14.4059C3.11112 14.3259 3.06576 14.2345 3.03935 14.137C3.01295
                       14.0394 3.00601 13.9377 3.01894 13.8374C3.03187 13.7372 3.06441 13.6405 3.11471 13.5529L5.02977
                       10.2015C4.35711 9.62037 3.73856 8.97939 3.18174 8.28645C3.11229 8.20892 3.05938 8.11805 3.02623
                       8.01939C2.99307 7.92072 2.98037 7.81634 2.9889 7.71261C2.99744 7.60887 3.02702 7.50796 3.07584 
                       7.41604C3.12467 7.32412 3.19171 7.24311 3.27289 7.17797C3.35406 7.11282 3.44766 7.0649 3.54797 
                       7.03713C3.64828 7.00936 3.7532 7.00232 3.85632 7.01645C3.95944 7.03057 4.0586 7.06557 4.14775 
                       7.11929C4.2369 7.17301 4.31416 7.24434 4.37482 7.32892C5.96433 9.29569 8.745 11.6378 12.9715 
                       11.6378C17.1981 11.6378 19.9788 9.29282 21.5683 7.32892C21.6283 7.24261 21.7053 7.16957 21.7948 
                       7.11433C21.8842 7.05909 21.984 7.02285 22.088 7.00784C22.192 6.99284 22.298 6.99941 22.3994 
                       7.02713C22.5008 7.05485 22.5954 7.10314 22.6773 7.16899C22.7592 7.23483 22.8267 7.31683 22.8756
                       7.40988C22.9244 7.50293 22.9536 7.60504 22.9613 7.70986C22.969 7.81467 22.9551 7.91995 22.9204
                       8.01915C22.8856 8.11834 22.8309 8.20933 22.7595 8.28645C22.2026 8.97939 21.5841 9.62037 20.9114 
                       10.2015L22.8265 13.5529C22.8779 13.6402 22.9114 13.7369 22.9252 13.8374C22.939 13.9378 22.9327 
                       14.04 22.9067 14.1379C22.8807 14.2359 22.8355 14.3277 22.7737 14.4081C22.7119 14.4885 22.6348 
                       14.5558 22.5469 14.6062Z" fill="#5B4296"/>
                    </g>
                    </svg>      
            </span> 
        </div>
    
        <button onclick="window.location.href='/static/forgot-password.html' + '?redirectUrl=' + redirectUrl;" 
            style="text-align: left; display: block; font-size: 12px; margin: 0px;"  
            class="link-button">
            <span data-translate="forgot-password-button">Forgot password?</span>
        </button>
        
        <button type="submit" data-translate="login-button">Login</button>
    </form>
    <div id="message"></div>
      <!-- Кнопка "Восстановить доступ" -->
    <button id="recovery-btn" class="link-button" data-translate="recovery-button">Восстановить доступ</button>
   
    <p>
        <div class="g-signin2" data-onsuccess="onSignIn"></div>
        <button class="google-signin-btn" id='google-btn' onclick="signInWithGoogle()">
            <img src="https://developers.google.com/identity/images/g-logo.png" alt="Google Icon" width="20" height="20"> <span data-translate="login-button-google">Login</span>
        </button>
    </p>
    <button class="custom-btn facebook-btn" id='facebook-btn' onclick="signInWithFacebook()">
        <img src="https://upload.wikimedia.org/wikipedia/commons/5/51/Facebook_f_logo_%282019%29.svg" alt="Facebook Icon" width="20" height="20"> <span data-translate="login-button-facebook"></span>
    </button>

    <div style="display: flex; align-items: center; justify-content: center; gap: 1px; white-space: nowrap; color: #7f69bd; font-size: 14px;">
        <span data-translate="no-account-text">Нет аккаунта?</span> 
        <button onclick="window.location.href='/static/signup.html' + '?redirectUrl=' + redirectUrl;"
            class="link-button" data-translate="registration-button" 
            style="margin: 0; padding: 0; border: none; background: none; font-size: 14px; line-height: 1; height: auto; width: auto; display: inline;">Register</button>
    </div> <br>

        <div class="top-panel">
            <div class="language-switcher">
                <select id="lang-select" onchange="switchLanguage(this.value)">
                    <option value="ru" data-icon="flag_ru.svg">Русский</option>
                    <option value="zh" data-icon="flag_cn.svg">中文</option>
                    <option value="en" data-icon="flag_en.svg">English</option>
                    <option value="uk" data-icon="flag_uk.svg">Українська</option>
                </select>
            </div>
        </div>
    <!-- Модальное окно для восстановления доступа -->
<div id="recovery-modal" class="modal">
    <div class="modal-content">
        <span class="close-btn" id="close-modal">&times;</span>
        <h1 data-translate="recovery-modal-title">Восстановление доступа</h1>
        <p data-translate="recovery-modal-select-method">Выберите способ восстановления:</p>
        <button id="super-password-btn" data-translate="recovery-modal-super-password-btn">Ввести супер-пароль</button><br>
        <button id="file-upload-btn" data-translate="recovery-modal-file-upload-btn">Прикрепить файл восстановления</button>
        <label for="email" id="email-recovery-label" data-translate="recovery-modal-email-label">Email:</label>
        <input type="email" id="email-recovery" name="username" required><br>

        <!-- Поле для ввода супер-пароля -->
        <div id="super-password-field" style="display:none;">
            <label for="super-password" data-translate="recovery-modal-super-password-label">Супер-пароль:</label>
            <input type="password" id="super-password" name="super-password">
        </div>
        <!-- Поле для прикрепления файла восстановления  -->
        <div id="file-upload-field" style="display:none;width: 180px;border-radius: 5px; border: 1px solid #ccc; padding: 10px;">
            <label for="recovery-file" data-translate="recovery-modal-recovery-file-label">Файл восстановления:</label>
            <input type="file" id="recovery-file" name="recovery-file" style="display:none;">
            <button id="custom-file-upload-btn" data-translate="recovery-modal-choose-file">Выберите файл</button><br>
            <span id="file-name" data-translate="recovery-modal-no-file">Файл не выбран</span>
        </div>


        <button id="send-recovery-btn" data-translate="recovery-modal-send-btn">Отправить</button>
    </div>
</div>


<script>
    // Открытие модального окна
    document.getElementById('recovery-btn').onclick = function() {
        document.getElementById('recovery-modal').style.display = 'block';
        document.getElementById('email-recovery').style.display = 'none';
        document.getElementById('email-recovery-label').style.display = 'none';
        document.getElementById('send-recovery-btn').style.display = 'none';
        document.getElementById('file-upload-field').style.display = 'none';
        document.getElementById('super-password-field').style.display = 'none';

    }

    // Закрытие модального окна
    document.getElementById('close-modal').onclick = function() {
        document.getElementById('recovery-modal').style.display = 'none';
    }

    // Ввод супер-пароля
    document.getElementById('super-password-btn').onclick = function() {
        document.getElementById('super-password-field').style.display = 'block';
        document.getElementById('file-upload-field').style.display = 'none';
        document.getElementById('email-recovery').style.display = 'block';
        document.getElementById('email-recovery-label').style.display = 'block';
        document.getElementById('send-recovery-btn').style.display = 'block';
    }

    // Прикрепление файла восстановления
    document.getElementById('file-upload-btn').onclick = function() {
        document.getElementById('file-upload-field').style.display = 'block';
        document.getElementById('super-password-field').style.display = 'none';
        document.getElementById('email-recovery').style.display = 'block';
        document.getElementById('email-recovery-label').style.display = 'block';
        document.getElementById('send-recovery-btn').style.display = 'block';
    }

        document.getElementById('custom-file-upload-btn').addEventListener('click', function () {
        document.getElementById('recovery-file').click(); // Открыть окно выбора файла
});

        function togglePassword() {
                let passwordField = document.getElementById("password");
                let eyeIcon = document.getElementById("eyeIcon");

                if (passwordField.type === "password") {
                    passwordField.type = "text";
                    eyeIcon.innerHTML = `
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M22.1918 11.4766C22.1623 11.41 21.4476 9.82457 19.8588 8.23578C17.7418 6.11881 15.068 
                          5 12.125 5C9.182 5 6.50815 6.11881 4.39118 8.23578C2.8024 9.82457 2.08437 11.4125 2.05821 
                          11.4766C2.01983 11.563 2 11.6564 2 11.7508C2 11.8453 2.01983 11.9387 2.05821 12.0251C2.08774 
                          12.0917 2.8024 13.6763 4.39118 15.2651C6.50815 17.3812 9.182 18.5 12.125 18.5C15.068 18.5 
                          17.7418 17.3812 19.8588 15.2651C21.4476 13.6763 22.1623 12.0917 22.1918 12.0251C22.2302 
                          11.9387 22.25 11.8453 22.25 11.7508C22.25 11.6564 22.2302 11.563 22.1918 11.4766ZM12.125 
                          17.15C9.52794 17.15 7.25909 16.2059 5.3809 14.3445C4.61028 13.5781 3.95464 12.7042 3.43437 
                          11.75C3.95444 10.7957 4.6101 9.92172 5.3809 9.15547C7.25909 7.29416 9.52794 6.35 12.125 
                          6.35C14.7221 6.35 16.9909 7.29416 18.8691 9.15547C19.6412 9.92159 20.2983 10.7955 20.8198 
                          11.75C20.2115 12.8857 17.5613 17.15 12.125 17.15ZM12.125 7.7C11.324 7.7 10.541 7.93753 
                          9.87494 8.38255C9.20892 8.82757 8.68982 9.46009 8.38328 10.2001C8.07675 10.9402 7.99655 
                          11.7545 8.15282 12.5401C8.30909 13.3257 8.69481 14.0474 9.26121 14.6138C9.82762 15.1802 
                          10.5493 15.5659 11.3349 15.7222C12.1205 15.8785 12.9348 15.7983 13.6749 15.4917C14.4149 
                          15.1852 15.0474 14.6661 15.4925 14.0001C15.9375 13.334 16.175 12.551 16.175 11.75C16.1739 
                          10.6762 15.7468 9.64674 14.9876 8.88745C14.2283 8.12817 13.1988 7.70112 12.125 7.7ZM12.125 
                          14.45C11.591 14.45 11.069 14.2917 10.625 13.995C10.1809 13.6983 9.83488 13.2766 9.63052 
                          12.7833C9.42617 12.2899 9.3727 11.747 9.47688 11.2233C9.58106 10.6995 9.83821 10.2184 
                          10.2158 9.84082C10.5934 9.46321 11.0745 9.20606 11.5983 9.10188C12.122 8.9977 12.6649 
                          9.05117 13.1582 9.25553C13.6516 9.45989 14.0733 9.80595 14.37 10.25C14.6666 10.694 14.825 
                          11.216 14.825 11.75C14.825 12.4661 14.5405 13.1528 14.0342 13.6592C13.5278 14.1655 12.8411 
                          14.45 12.125 14.45Z" fill="#5B4296"/>
                        </svg>


                    `;
                } else {
                    passwordField.type = "password";
                    eyeIcon.innerHTML = `
                    <svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g id="icon / 24x24 / eye closed">
                    <path id="Vector" d="M22.5469 14.6062C22.4594 14.6561 22.3629 14.6882 22.263 14.7008C22.163
                       14.7133 22.0616 14.7061 21.9645 14.6794C21.8674 14.6527 21.7765 14.6071 21.697 14.5453C21.6175
                       14.4834 21.551 14.4065 21.5013 14.3189L19.6819 11.1399C18.6242 11.8551 17.4575 12.3938 16.2272
                       12.7351L16.7892 16.1076C16.8058 16.2069 16.8027 16.3084 16.78 16.4065C16.7573 16.5046 16.7155 
                       16.5972 16.657 16.6791C16.5985 16.761 16.5244 16.8306 16.439 16.8838C16.3535 16.9371 16.2585 
                       16.973 16.1592 16.9895C16.1183 16.9962 16.077 16.9997 16.0357 17C15.8544 16.9997 15.6792 16.9352
                       15.541 16.8179C15.4029 16.7006 15.3108 16.5382 15.2811 16.3594L14.7286 13.0483C13.5635 13.2104 
                       12.3815 13.2104 11.2164 13.0483L10.6639 16.3594C10.6342 16.5385 10.5418 16.7012 10.4033 
                       16.8186C10.2647 16.9359 10.089 17.0002 9.90745 17C9.8651 16.9998 9.82284 16.9963 9.78105 
                       16.9895C9.68175 16.973 9.58668 16.9371 9.50127 16.8838C9.41585 16.8306 9.34177 16.761 9.28326
                       16.6791C9.22474 16.5972 9.18294 16.5046 9.16025 16.4065C9.13756 16.3084 9.13441 16.2069 9.15099
                       16.1076L9.71594 12.7351C8.48611 12.3927 7.32 11.853 6.26308 11.137L4.44951 14.3189C4.39921 
                       14.4066 4.33214 14.4834 4.25213 14.5452C4.17212 14.6069 4.08074 14.6522 3.9832 14.6786C3.88566
                       14.7051 3.78387 14.712 3.68365 14.6991C3.58343 14.6861 3.48674 14.6536 3.3991 14.6033C3.31145
                       14.553 3.23457 14.4859 3.17285 14.4059C3.11112 14.3259 3.06576 14.2345 3.03935 14.137C3.01295
                       14.0394 3.00601 13.9377 3.01894 13.8374C3.03187 13.7372 3.06441 13.6405 3.11471 13.5529L5.02977
                       10.2015C4.35711 9.62037 3.73856 8.97939 3.18174 8.28645C3.11229 8.20892 3.05938 8.11805 3.02623
                       8.01939C2.99307 7.92072 2.98037 7.81634 2.9889 7.71261C2.99744 7.60887 3.02702 7.50796 3.07584 
                       7.41604C3.12467 7.32412 3.19171 7.24311 3.27289 7.17797C3.35406 7.11282 3.44766 7.0649 3.54797 
                       7.03713C3.64828 7.00936 3.7532 7.00232 3.85632 7.01645C3.95944 7.03057 4.0586 7.06557 4.14775 
                       7.11929C4.2369 7.17301 4.31416 7.24434 4.37482 7.32892C5.96433 9.29569 8.745 11.6378 12.9715 
                       11.6378C17.1981 11.6378 19.9788 9.29282 21.5683 7.32892C21.6283 7.24261 21.7053 7.16957 21.7948 
                       7.11433C21.8842 7.05909 21.984 7.02285 22.088 7.00784C22.192 6.99284 22.298 6.99941 22.3994 
                       7.02713C22.5008 7.05485 22.5954 7.10314 22.6773 7.16899C22.7592 7.23483 22.8267 7.31683 22.8756
                       7.40988C22.9244 7.50293 22.9536 7.60504 22.9613 7.70986C22.969 7.81467 22.9551 7.91995 22.9204
                       8.01915C22.8856 8.11834 22.8309 8.20933 22.7595 8.28645C22.2026 8.97939 21.5841 9.62037 20.9114 
                       10.2015L22.8265 13.5529C22.8779 13.6402 22.9114 13.7369 22.9252 13.8374C22.939 13.9378 22.9327 
                       14.04 22.9067 14.1379C22.8807 14.2359 22.8355 14.3277 22.7737 14.4081C22.7119 14.4885 22.6348 
                       14.5558 22.5469 14.6062Z" fill="#5B4296"/>
                    </g>
                    </svg>




                    `;
                }
            }

    document.getElementById('recovery-file').addEventListener('change', function () {
    const fileName = this.files[0] ? this.files[0].name : translations[selectedLanguage]["recovery-modal-no-file"];
    document.getElementById('file-name').textContent = fileName;
});
    // Закрытие модального окна при клике вне его
    window.onclick = function(event) {
        if (event.target == document.getElementById('recovery-modal')) {
            document.getElementById('recovery-modal').style.display = 'none';
        }
    }
// Обработка отправки данных формы
document.getElementById('send-recovery-btn').addEventListener('click', async function() {
    const email = document.getElementById('email-recovery').value;
    const recoveryFile = document.getElementById('recovery-file').files[0];
    const superPassword = document.getElementById('super-password').value;

    if (recoveryFile) {
        // Если файл прикреплен, используем восстановление по файлу
        const formData = new FormData();
        formData.append('email', email);
        formData.append('file', recoveryFile);

        try {
            const response = await fetch('api/auth/restore_account_by_recovery_file', {
                method: 'POST',
                body: formData 
            });

            if (response.ok) {
               
            const result = await response.json();
            console.log('Ответ сервера:', result); 
          //  console.log('Ответ сервера:', response); 
            alert('Успешное восстановление доступа по файлу');
            localStorage.setItem('access_token', result.access_token);
            setTimeout(() => {
                            const refreshToken = result.refresh_token;
                            const accessToken = result.access_token;

                            urlParams.set('access_token', accessToken);
                            urlParams.set('refresh_token', refreshToken);

                            const queryString = urlParams.toString();
                            // const url = `${redirectUrl}/?access_token=${accessToken}&refresh_token=${refreshToken}`;
                            const url = `/static/mainscreen.html/?access_token=${accessToken}`;

                            window.location.href = url;
                        }, 500);


            } else {
                const errorData = await response.json();
                alert(`Ошибка: ${errorData.detail}`);
                const errorMessage = getErrorMessage(xhr.status, messageDiv);
                console.error("Error during login.");
                messageDiv.innerText = errorMessage;
                messageDiv.style.color = 'red';
            }
        } catch (error) {
            alert('Произошла ошибка при восстановлении доступа по файлу');
        }
    } else if (superPassword) {
        // Если введен супер-пароль, используем восстановление по супер-паролю
        const body = {
            email: email,
            recovery_code: superPassword
        };

        try {
            const response = await fetch('api/auth/restore_account_by_text', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(body)
            });

            if (response.ok) {
                const result = await response.json();
                console.log('Ответ сервера:', result);
                alert('Успешное восстановление доступа по супер-паролю');
                localStorage.setItem('access_token', result.access_token);
                setTimeout(() => {
                            const refreshToken = result.refresh_token;
                            const accessToken = result.access_token;

                            urlParams.set('access_token', accessToken);
                            urlParams.set('refresh_token', refreshToken);

                            const queryString = urlParams.toString();
                            // const url = `${redirectUrl}/?access_token=${accessToken}&refresh_token=${refreshToken}`;
                            const url = `/static/mainscreen.html/?access_token=${accessToken}`;

                            window.location.href = url;
                        }, 500);

                    // } else {
                    //     const errorMessage = getErrorMessage(xhr.status, messageDiv);
                    //     // console.error("Error during login.");
                    //     messageDiv.innerText = errorMessage;
                    //     messageDiv.style.color = 'red';
                    // }
              
            } else {
                const errorData = await response.json();
                alert(`Ошибка: ${errorData.detail}`);
                const errorMessage = getErrorMessage(xhr.status, messageDiv);
                console.error("Error during login.");
                messageDiv.innerText = errorMessage;
                messageDiv.style.color = 'red';
            }
        } catch (error) {
            alert('Произошла ошибка при восстановлении доступа по супер-паролю');
        }
    } else {
        alert('Пожалуйста, выберите способ восстановления и заполните необходимые поля.');
    }
});


</script>


<script>
document.addEventListener('DOMContentLoaded', function() {
    const storedLang = localStorage.getItem('selectedLanguage');
    const browserLang = navigator.language || navigator.userLanguage;
    let defaultLang;

    if (storedLang) {
        defaultLang = storedLang;
    } else if (browserLang) {
        defaultLang = browserLang.startsWith('ru') ? 'ru' :
                      browserLang.startsWith('en') ? 'en' :
                      browserLang.startsWith('zh') ? 'zh' : 
                      browserLang.startsWith('uk') ? 'uk':'ru';
    } else {
        defaultLang = 'en';
    }

    setLanguage(defaultLang);
     // Установка значения селектора языка на загруженный язык
     const langSelect = document.getElementById('lang-select');
    langSelect.value = defaultLang;

        // Инициализация Select2 для выпадающего списка языка
        $('#lang-select').select2({
            templateResult: formatState,
            templateSelection: formatState,
            minimumResultsForSearch: Infinity
        });
    });

    document.addEventListener('DOMContentLoaded', function() {
        const GoogleBtn = document.getElementById('google-btn');
        const FaceBookBtn = document.getElementById('facebook-btn');

        const emailField = document.getElementById('email');
        const passwordField = document.getElementById('password');
        const loginButton = document.querySelector('button[type="submit"]');

        function checkFormValidity() {
                if (emailField.value && passwordField.value) {
                    loginButton.disabled = false;
                    loginButton.classList.add('active'); // активируем стиль
                } else {
                    loginButton.disabled = true;
                    loginButton.classList.remove('active'); // убираем активный стиль
                }
            }

            emailField.addEventListener('input', checkFormValidity);
            passwordField.addEventListener('input', checkFormValidity);

            checkFormValidity(); 
        
        console.log('DOM fully loaded and parsed');
        
        // Делаем AJAX-запрос к Python приложению для получения настроек
        fetch('/get_social_login_settings')
            .then(response => response.json())
            .then(data => {
                // console.log('Settings received:', data);
                // Приводим строковые значения к булевым
                const googleLoginEnabled = data.google_login === 'True';
                const facebookLoginEnabled = data.facebook_login === 'True';
                // console.log('googleLoginEnabled:', googleLoginEnabled);
                // console.log('facebookLoginEnabled:', facebookLoginEnabled);
                // Показываем или скрываем кнопки в зависимости от настроек
                if (!googleLoginEnabled) {
                    // console.log('Hiding Google login button');
                    GoogleBtn.style.display = 'none';
                }
                if (!facebookLoginEnabled) {
                    // console.log('Hiding Facebook login button');
                    FaceBookBtn.style.display = 'none';
                }
                
                
            })
            .catch(error => console.error('Error fetching settings:', error));
        });
        
</script>

<script>
    const urlParams = new URLSearchParams(window.location.search);
    let redirectUrl = urlParams.get('redirectUrl');

    if (redirectUrl == null) {
        console.log('redirectUrl');
    } else {
        redirectUrl = redirectUrl.trim();
    }
    if (redirectUrl !== null) {
        redirectUrl = decodeURIComponent(redirectUrl);
    }
    localStorage.setItem('redirectUrl', redirectUrl);

    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('login-form');
        const messageDiv = document.getElementById('message');

                    // Получаем текущий URL
            const currentUrl = window.location.href;

            // Создаем объект URL
            const url = new URL(currentUrl);

            // Извлекаем параметры из строки запроса
            const searchParams = url.searchParams;

            // Получаем значения redirect_url и cor-id
            const redirectUrl = searchParams.get('redirectUrl'); // Указываем ключ 'redirectUrl'
            const corId = searchParams.get('corId'); // Указываем ключ 'cor_id'



            // Сохраняем их в localStorage
            if (redirectUrl) {
                localStorage.setItem('redirectUrl', redirectUrl);
                console.log('Redirect URL сохранен в localStorage:', redirectUrl);
            } else {
                console.warn('Redirect URL отсутствует в строке запроса.');
            }

            if (corId) {
                localStorage.setItem('cor_id', corId);
                console.log('COR-ID сохранен в localStorage:', corId);
            } else {
                console.warn('COR-ID отсутствует в строке запроса.');
            }

        form.addEventListener('submit', (event) => {
            event.preventDefault();

            const formData = new FormData(form);
            const params = new URLSearchParams();

            formData.forEach((value, key) => {
                params.append(key, value);
            });

            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/api/auth/login");
            xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");

            xhr.onreadystatechange = function() {
                if (xhr.readyState === XMLHttpRequest.DONE) {
                    if (xhr.status === 200) {
                        const response = JSON.parse(xhr.responseText);
                        console.log("Successful login.");
                        console.log("Response from server:", response); // Логируем ответ от сервера
                        const userLang = localStorage.getItem('selectedLanguage');
                        console.log("isAdmin from server:", response.is_admin);
                        // Сохраняем информацию о том, является ли пользователь администратором
                        localStorage.setItem('isAdmin', response.is_admin); // Сохраняем статус администратора
                        // Проверяем, что мы сохранили значение правильно
                        console.log("isAdmin stored in localStorage:", localStorage.getItem('isAdmin'));
                        // console.log("__________translation___________");
                        // console.log(translations); // Проверить объект translations в консоли
                        // console.log("_____________userLang____________");
                        // console.log(userLang); // Проверить значение userLang в консоли
                        // console.log("_____________translations[userLang]____________");
                        // console.log(translations[userLang]); // Проверить значение translations[userLang] в консоли
                        // console.log("_____________messageDiv.innerText____________");
                        // console.log(translations[userLang]["message-ok"]);
                        // console.log(errorMessage); // Проверить значение errorMessage в консоли
                        messageDiv.innerText = "Successful login"
                        // messageDiv.innerText = translations[userLang]["message-ok"];
                        messageDiv.style.color = 'green';

                        setTimeout(() => {
                            const refreshToken = response.refresh_token;
                            const accessToken = response.access_token;

                            const accessToken_rcv = new URLSearchParams(window.location.search).get('access_token');
                            const refreshToken_rcv = new URLSearchParams(window.location.search).get('refresh_token');
                            const savedRedirectUrl_rcv = localStorage.getItem('redirectUrl');

                        if (savedRedirectUrl_rcv && accessToken_rcv) {
                            // Перенаправляем на savedRedirectUrl с access_token и cor_id
                            window.location.href = `${savedRedirectUrl_rcv}?access_token=${accessToken_rcv}&refresh_token=${refreshToken_rcv}`;
                        } else {
                           console.log(" Не найдены параметры redirect_url или cor_id.");

                            urlParams.set('access_token', accessToken);
                            urlParams.set('refresh_token', refreshToken);
                            const queryString = urlParams.toString();
                            // const url = `${redirectUrl}/?access_token=${accessToken}&refresh_token=${refreshToken}`;
                            const url = `/static/mainscreen.html/?access_token=${accessToken}&refresh_token=${refreshToken}`;
                            window.location.href = url;
                              }

                        }, 500);

                    } else {
                        const errorMessage = getErrorMessage(xhr.status, messageDiv);
                        // console.error("Error during login.");
                        messageDiv.innerText = errorMessage;
                        messageDiv.style.color = 'red';
                    }
                }
            };

            xhr.send(params);
        });
    });

    function getErrorMessage(status, messageDiv) {
        const userLang = localStorage.getItem('selectedLanguage');
        switch(status) {      
            case 401:
                // messageDiv.innerText = translations[userLang]["message-error"];
                messageDiv.style.color = 'red';
                return "Invalid username or password.";
            case 404:
                messageDiv.innerText = "User not registered!";
                messageDiv.style.color = 'red';
                return "User not registered!";
            case 403:
                return "Access denied.";
            default:
                // console.error("Error during login.");
                // console.log(translations); // Проверить объект translations в консоли
                // console.log(userLang); // Проверить значение userLang в консоли
                // console.log(translations[userLang]); // Проверить значение translations[userLang] в консоли
                // console.log(errorMessage); // Проверить значение errorMessage в консоли
                // messageDiv.innerText = translations[userLang]["message-error"];
                messageDiv.style.color = 'red';
                return "Error during login.";
        }
    }

    function onSignIn(googleUser) {
        var profile = googleUser.getBasicProfile();
        console.log('ID: ' + profile.getId());
        console.log('Name: ' + profile.getName());
        console.log('Image URL: ' + profile.getImageUrl());
        console.log('Email: ' + profile.getEmail());
        // Здесь вы можете отправить данные на ваш сервер для аутентификации
    }

    function signInWithGoogle() {
        console.log('Google sign-in button clicked');
        var auth2 = gapi.auth2.getAuthInstance();
        if (auth2) {
            auth2.signIn().then(function(googleUser) {
                onSignIn(googleUser);
            }, function(error) {
                console.error('Error signing in with Google: ', error);
            });
        } else {
            console.error('Google API not initialized.');
        }
    }

    window.fbAsyncInit = function() {
        FB.init({
            appId      : '1580389042741794',
            cookie     : true,
            xfbml      : true,
            version    : 'v15.0'
        });
    };

    (function(d, s, id){
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement(s); js.id = id;
        js.src = "https://connect.facebook.net/en_US/sdk.js";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));

    function signInWithFacebook() {
        console.log('Facebook sign-in button clicked');
        FB.login(function(response) {
            if (response.status === 'connected') {
                var accessToken = response.authResponse.accessToken;
                FB.api('/me', {fields: 'name,email,picture'}, function(profile) {
                    console.log('ID: ' + profile.id);
                    console.log('Name: ' + profile.name);
                    console.log('Image URL: ' + profile.picture.data.url);
                    console.log('Email: ' + profile.email);
                    // Здесь вы можете отправить данные на ваш сервер для аутентификации
                });
            } else {
                console.log('Not authenticated with Facebook.');
            }
        }, {scope: 'public_profile,email'});
    }

    function loadGoogleAPI() {
        gapi.load('auth2', function() {
            gapi.auth2.init().then(function() {
                console.log('Google API initialized');
            }, function(error) {
                console.error('Error initializing Google API: ', error);
            });
        });
    }

  //  window.onload = function() {
  //      loadGoogleAPI();
  //      setLanguage(defaultLang); // Установка языка при загрузке страницы
  //  };
</script>


<script>
    // Функция для отображения изображений в Select2
    function formatState(state) {
        if (!state.id) {
            return state.text;
        }
        var baseUrl = 'static/flags';
        var $state = $(
            '<span><img src="' + baseUrl + '/' + state.element.getAttribute('data-icon') + '" class="flag-img" /> ' + state.text + '</span>'
        );
        return $state;
    }

    // Функция для переключения языка
    function switchLanguage(language) {
        setLanguage(language);
        const langSelect = document.getElementById('lang-select');
        langSelect.value = language;
        localStorage.setItem('selectedLanguage', language); // Сохраняем выбранный язык в localStorage
    }

    // Функция для установки языка
    function setLanguage(language) {
        document.querySelectorAll("[data-translate]").forEach(function(element) {
            const key = element.getAttribute("data-translate");
            element.innerText = translations[language][key];
           
        });
    }
</script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0-beta.1/js/select2.min.js"></script>

</body>
</html>